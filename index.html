<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title></title><style>*{box-sizing:border-box}.cxs-display-table{display:table}.cxs-2947628758 pre .hljs-number{color:#e08}.cxs-3954183383{font-size:24px}.cxs-2947628758 a:hover{text-decoration:underline}.cxs-4066908388{clear:both}.cxs-799160745{font-size:48px}.cxs-1246195080{margin-left:-8px;margin-right:-8px}.cxs-2947628758{}.cxs-2947628758 h1{font-weight:600;line-height:1.25;font-size:48px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h2{font-weight:600;line-height:1.25;font-size:24px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h3{font-weight:600;line-height:1.25;font-size:20px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h4{font-weight:600;line-height:1.25;font-size:16px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h5{font-weight:600;line-height:1.25;font-size:14px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 h6{font-weight:600;line-height:1.25;font-size:12px;margin-top:32px;margin-bottom:8px}.cxs-2947628758 p{overflow-x:auto;margin-top:0px;margin-bottom:16px}.cxs-2947628758 code{font-family:Menlo, monospace;font-size:14px;padding:4px;background-color:#eee;border-radius:2px}.cxs-2947628758 pre{font-family:Menlo, monospace;font-size:14px;overflow-x:auto;padding:16px;margin-top:8px;margin-bottom:32px;background-color:#eee;border-radius:2px}.cxs-2947628758 pre .hljs-keyword{color:#08e}.cxs-2947628758 pre .hljs-built_in{color:#059}.cxs-2947628758 pre .hljs-type{color:#059}.cxs-2947628758 pre .hljs-literal{color:#08e}.cxs-2947628758 a{color:#08e;text-decoration: none}.cxs-2947628758 pre .hljs-regexp{color:#08e}.cxs-2947628758 pre .hljs-string{color:#059}.cxs-2947628758 pre .hljs-subst{color:#059}.cxs-2947628758 pre .hljs-symbol{color:#08e}.cxs-2947628758 pre .hljs-class{color:#08e}.cxs-2947628758 pre .hljs-function{color:#e08}.cxs-2947628758 pre .hljs-title{color:#08e}.cxs-2947628758 pre .hljs-params{color:#059}.cxs-2947628758 pre .hljs-comment{color:#059}.cxs-2947628758 pre .hljs-doctag{color:#059}.cxs-2947628758 pre .hljs-meta{color:#059}.cxs-2947628758 pre .hljs-meta-keyword{color:#08e}.cxs-2947628758 pre .hljs-meta-string{color:#08e}.cxs-2947628758 hr{margin-top:48px;margin-bottom:48px;border:0px;border-bottom-style:solid;border-bottom-width:1px;border-bottom:2px solid #ddd}.cxs-2947628758 table{border-collapse:separate;border-spacing:0px;max-width:100%;width:100%}.cxs-2947628758 th{text-align:left;line-height:inherit;vertical-align:bottom}.cxs-2947628758 td{vertical-align:top;line-height:inherit}.cxs-2947628758 img{max-width: 100%;height: auto;margin-top:16px;margin-bottom:16px}.cxs-2947628758 ul{padding-left:32px;margin-top:0px;margin-bottom:16px}@media screen and (min-width: 52em) { .cxs-799160745{font-size:72px} }@media screen and (min-width: 52em) { .cxs-3954183383{} }</style></head><body style="margin:0;"><div class="Xv" style="font-family:-apple-system, BlinkMacSystemFont, sans-serif;font-weight:400;line-height:1.5;color:#111;background-color:#fff;"><nav style="display:flex;align-items:center;padding-top:8px;padding-bottom:8px;padding-left:16px;padding-right:16px;background-color:#fff;"><a href="https://github.com/cdimascio/swagger-spring-functional" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">GitHub</a></nav><header class="BannerHeader" style="display:flex;align-items:center;justify-content:center;text-align:left;min-height:100vh;color:white;background-color:#111;background-image:url(undefined);background-size:cover;background-position:center;"><div style="box-sizing:border-box;width:100%;max-width:1024px;margin-left:auto;margin-right:auto;padding-top:48px;padding-bottom:48px;padding-left:32px;padding-right:32px;"><h1 class="cxs-799160745" style="box-sizing:border-box;font-weight:600;line-height:1.25;margin:0;">swagger-spring-functional</h1><h2 class="cxs-3954183383" style="box-sizing:border-box;font-weight:600;line-height:1.25;margin:0;">A friendly kotlin library used to validate API endpoints against a Swagger 2.0 specification</h2><div class="cxs-1246195080" style="box-sizing:border-box;padding-top:16px;padding-bottom:16px;"><iframe src="https://platform.twitter.com/widgets/tweet_button.html?text=swagger-spring-functional%3A%20A%20friendly%20kotlin%20library%20used%20to%20validate%20API%20endpoints%20against%20a%20Swagger%202.0%20specification&amp;url=&amp;via=&amp;hashtags=&amp;size=" height="20" allowtransparency="true" frameborder="0" scrolling="no" style="box-sizing:border-box;width:61px;overflow:hidden;margin:8px;"></iframe><iframe src="https://ghbtns.com/github-btn.html?type=star&amp;count=true&amp;user=cdimascio&amp;repo=swagger-spring-functional&amp;size=" height="20" frameborder="0" scrolling="no" style="box-sizing:border-box;width:100px;overflow:hidden;margin:8px;"></iframe><div class="cxs-4066908388 cxs-display-table"></div></div></div></header><div class="cxs-2947628758" style="box-sizing:border-box;max-width:1024px;margin-left:auto;margin-right:auto;padding-top:32px;padding-bottom:32px;padding-left:32px;padding-right:32px;"><article style="box-sizing:border-box;"><div>
<p><img src="https://travis-ci.org/cdimascio/openapi-spring-webflux-validator.svg?branch=master" /><a href="https://www.codacy.com/app/cdimascio/openapi-spring-webflux-validator?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=cdimascio/openapi-spring-webflux-validator&amp;utm_campaign=Badge_Grade"><img src="https://api.codacy.com/project/badge/Grade/f78b72ca90104e42b111723a7720adf3" /></a><img src="https://img.shields.io/badge/license-Apache%202.0-blue.svg" /></p>
<p>A friendly kotlin library to validate API endpoints using an <em>OpenApi 3.0.0</em> or <em>Swagger 2.0</em> specification. Great with webflux functional. 
It <strong>works happily with any JVM language including Java &gt;=8</strong>. </p>
<p>
    <img src="https://raw.githubusercontent.com/cdimascio/openapi-spring-webflux-validator/master/assets/openapi-spring5-webflux-validator.png" />
</p>

<p>Supports specifications in <em>YAML</em> and <em>JSON</em></p>
<p>See this <a href="https://github.com/cdimascio/kotlin-swagger-spring-functional-template">complete Spring 5 Webflux example that uses openapi-spring-webflux-validator</a>.</p>
<h2>Prequisites</h2>
<p>Java 8 or greater</p>
<h2>Install</h2>
<h3>Maven</h3>
<pre><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.github.cdimascio<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>openapi-spring-webflux-validator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></pre><h3>Gradle</h3>
<pre>compile <span class="hljs-string">'io.github.cdimascio:openapi-spring-webflux-validator:2.0.0'</span></pre><p>For sbt, grape, ivy and more, see <a href="https://search.maven.org/#artifactdetails%7Cio.github.cdimascio%7Copenapi-spring-webflux-validator%7C2.0.0%7Cjar">here</a></p>
<h2>Usage (Kotlin)</h2>
<p>This section and the next describe usage with Kotlin and Java respectively.</p>
<h3>Configure (Kotlin)</h3>
<p>This one-time configuration requires you to provide the <em>location of the openapi/swagger specification</em> and an optional <em>custom error handler</em>.</p>
<p>Supports <code>JSON</code> and <code>YAML</code></p>
<pre><span class="hljs-keyword">import</span> io.github.cdimascio.swagger.Validate
<span class="hljs-keyword">val</span> validate = Validate.configure(<span class="hljs-string">&quot;static/api.yaml&quot;</span>)</pre><p>with custom error handler</p>
<pre><span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyError</span></span>(<span class="hljs-keyword">val</span> id: String, <span class="hljs-keyword">val</span> messages: List&lt;String&gt;)
<span class="hljs-keyword">val</span> validate = Validate.configure(<span class="hljs-string">&quot;static/api.json&quot;</span>) { status, messages -&gt;
   Error(status.name, messages)
}</pre><h3>Validate a request (Kotlin)</h3>
<p>Using the <code>validate</code> instance created above, you can now validate a request:</p>
<p>without a body</p>
<pre>validate.request(req) {
    <span class="hljs-comment">// Do stuff e.g. return a list of names </span>
    ok().body(Mono.just(listOf(<span class="hljs-string">&quot;carmine&quot;</span>, <span class="hljs-string">&quot;alex&quot;</span>, <span class="hljs-string">&quot;eliana&quot;</span>)))
}</pre><p>with body</p>
<pre>validate.request(req).withBody(User::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>) </span>{ body -&gt;
    <span class="hljs-comment">// Note that body is deserialized as User!</span>
    <span class="hljs-comment">// Now you can do stuff. </span>
    <span class="hljs-comment">// For example, lets echo the request as the response </span>
    ok().body(Mono.just(body))
}</pre><h2>Usage (Java 8 <em>or greater</em>)</h2>
<h3>Configure (Java)</h3>
<p>This one-time configuration requires you to provide the <em>location of the openapi/swagger specification</em> and an optional <em>custom error handler</em>.</p>
<pre><span class="hljs-keyword">import</span> io.github.cdimascio.swagger.Validate;
Validate&lt;ValidationError&gt; validate = Validate.configure(<span class="hljs-string">&quot;static/api.json&quot;</span>)</pre><p>with custom error handler</p>
<pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyError</span> </span>{
    <span class="hljs-keyword">private</span> String id;
    <span class="hljs-keyword">private</span>  String messages;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyError</span><span class="hljs-params">(String id, List&lt;String&gt; messages)</span> </span>{
        <span class="hljs-keyword">this</span>.id = id;
        <span class="hljs-keyword">this</span>.messages = messages;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> id;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span><span class="hljs-params">(String id)</span> </span>{
        <span class="hljs-keyword">this</span>.id = id;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">getMessages</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> messages;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMessages</span><span class="hljs-params">(List&lt;String&gt; messages)</span> </span>{
        <span class="hljs-keyword">this</span>.messages = messages;
    }     
}</pre><pre>Validate&lt;ValidationError&gt; validate = Validate.configure(<span class="hljs-string">&quot;static/api.json&quot;</span>, (status, messages) -&gt;
    <span class="hljs-keyword">new</span> MyError(status.getName(), messages)
);</pre><h3>Validate a request (Java)</h3>
<p>Using the <code>validate</code> instance created above, you can now validate a request:</p>
<p>without a body</p>
<pre>ArrayList&lt;String&gt; users = <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;() {{
    add(<span class="hljs-string">&quot;carmine&quot;</span>);
    add(<span class="hljs-string">&quot;alex&quot;</span>);
    add(<span class="hljs-string">&quot;eliana&quot;</span>);
}};

validate.request(<span class="hljs-keyword">null</span>, () -&gt; {
    <span class="hljs-comment">// Do stuff e.g. return a list of user names</span>
    ServerResponse.ok().body(fromObject(users));
});</pre><p>with body</p>
<pre>validate
    .request(<span class="hljs-keyword">null</span>)
    .withBody(User.class, user -&gt; 
        <span class="hljs-comment">// Note that body is deserialized as User!</span>
        <span class="hljs-comment">// Now you can do stuff. </span>
        <span class="hljs-comment">// For example, lets echo the request as the response</span>
        <span class="hljs-keyword">return</span> ServerResponse.ok().body(fromObject(user))
    );</pre><h2>Example Valiation Output</h2>
<p>Let's assume a <code>POST</code> request to create a user requires the following request body:</p>
<pre>{
  <span class="hljs-attr">&quot;firstname&quot;</span>: <span class="hljs-string">&quot;carmine&quot;</span>,
  <span class="hljs-attr">&quot;lastname&quot;</span>: <span class="hljs-string">&quot;dimasico&quot;</span>
}</pre><p>Let's now assume an API user misspells <code>lastname</code> as <code>lastnam</code></p>
<pre>curl -X POST http://localhost:8080/api/users -H &quot;Content-Type: application/json&quot; -d'{ 
  &quot;firstname&quot;: &quot;c&quot;, 
  &quot;lastnam&quot;: &quot;d&quot; 
}'</pre><p><code>openapi-spring-webflux-validator</code> automatically validates the request against a Swagger spect and returns:</p>
<pre>{
  <span class="hljs-attr">&quot;code&quot;</span>: <span class="hljs-number">400</span>,
  <span class="hljs-attr">&quot;messages&quot;</span>:[
      <span class="hljs-string">&quot;Object instance has properties which are not allowed by the schema: [\&quot;lastnam\&quot;]&quot;</span>,
      <span class="hljs-string">&quot;Object has missing required properties ([\&quot;lastname\&quot;])&quot;</span>
  ]
}</pre><p><strong>Woah! Cool!!</strong> :-D </p>
<h2>Example</h2>
<p>Let's say you have an endpoint <code>/users</code> that supports both <code>GET</code> and <code>POST</code> operations.</p>
<p>You can create those routes and validate them like so:</p>
<p><strong>Create the routes:</strong></p>
<pre><span class="hljs-keyword">package</span> myproject.controllers

<span class="hljs-keyword">import</span> org.springframework.core.io.ClassPathResource
<span class="hljs-keyword">import</span> org.springframework.http.MediaType.*
<span class="hljs-keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse.permanentRedirect
<span class="hljs-keyword">import</span> org.springframework.web.reactive.function.server.router
<span class="hljs-keyword">import</span> java.net.URI

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Routes</span></span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> userHandler: UserHandler) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">router</span><span class="hljs-params">()</span></span> = router {
        <span class="hljs-string">&quot;/api&quot;</span>.nest {
            accept(APPLICATION_JSON).nest {
                POST(<span class="hljs-string">&quot;/users&quot;</span>, userHandler::create)
            }
            accept(TEXT_EVENT_STREAM).nest {
                GET(<span class="hljs-string">&quot;/users&quot;</span>, userHandler::findAll)
            }
        }
    }
}</pre><pre><span class="hljs-keyword">package</span> myproject

<span class="hljs-keyword">import</span> io.github.cdimascio.swagger.Validate
<span class="hljs-keyword">val</span> validate = Validate.configure(<span class="hljs-string">&quot;static/api.yaml&quot;</span>)</pre><p><strong>Validate with openapi-spring-webflux-validator</strong></p>
<pre><span class="hljs-keyword">package</span> myproject.controllers

<span class="hljs-keyword">import</span> myproject.models.User
<span class="hljs-keyword">import</span> myproject.validate
<span class="hljs-keyword">import</span> org.springframework.web.reactive.function.server.ServerRequest
<span class="hljs-keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse
<span class="hljs-keyword">import</span> org.springframework.web.reactive.function.server.ServerResponse.ok
<span class="hljs-keyword">import</span> org.springframework.web.reactive.function.server.body
<span class="hljs-keyword">import</span> reactor.core.publisher.Flux
<span class="hljs-keyword">import</span> reactor.core.publisher.Mono

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserHandler</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">findAll</span><span class="hljs-params">(req: <span class="hljs-type">ServerRequest</span>)</span></span>: Mono&lt;ServerResponse&gt; {
        <span class="hljs-keyword">return</span> validate.request(req) {
            ok().body(Mono.just(listOf(<span class="hljs-string">&quot;carmine&quot;</span>, <span class="hljs-string">&quot;alex&quot;</span>, <span class="hljs-string">&quot;eliana&quot;</span>)))
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">create</span><span class="hljs-params">(req: <span class="hljs-type">ServerRequest</span>)</span></span>: Mono&lt;ServerResponse&gt; {
        <span class="hljs-keyword">return</span> validate.request(req).withBody(User::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>) </span>{
            <span class="hljs-comment">// it is the request body deserialized as User</span>
            ok().body(Mono.just(it))
       }
    }
}</pre><h2>License</h2>
<p><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a></p>
</div></article></div><footer><div style="box-sizing:border-box;max-width:1024px;margin-left:auto;margin-right:auto;margin-bottom:32px;padding-top:8px;padding-bottom:8px;padding-left:32px;padding-right:32px;"><div style="margin-left:-16px;margin-right:-16px;"><a href="https://github.com/cdimascio/swagger-spring-functional" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">GitHub</a><a href="https://github.com/cdimascio" class="Link" style="box-sizing:border-box;color:inherit;display:inline-block;font-size:14px;line-height:16px;padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px;font-weight:600;text-decoration:none;">cdimascio</a></div><div></div></div></footer></div><div style="font-family:-apple-system, sans-serif;font-size:12px;font-weight:600;text-align:right;padding:24px;color:#333;background-color:#eee;"><a href="http://compositor.io" style="color:inherit;text-decoration:none;">Built with Compositor.io</a></div></body></html>